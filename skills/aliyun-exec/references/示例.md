## 用户需求配置Json
```json
{
  "intent_core": {
    "primary_intent": "DIAGNOSTIC_QUERY",
    "sub_intent": "DIAG_CONFIG",
    "complexity": "L3",
    "business_scenario": "安全审计",
    "confidence": 0.95
  },
  "entities": {
    "primary_entity": {
      "service": "slb",
      "resource_type": "loadbalancer_listener",
      "identifier_type": "all",
      "identifier_value": "*",
      "original_expression": "所有SLB实例"
    },
    "target_entities": [
      {
        "service": "slb",
        "resource_type": "acl",
        "identifier_type": "all",
        "identifier_value": "*",
        "original_expression": "访问控制列表"
      }
    ]
  },
  "relationships": {
    "relations": [
      {
        "type": "configured_with",
        "source": "slb_listener",
        "target": "acl",
        "description": "监听器配置ACL访问控制策略"
      }
    ],
    "relationship_path": ["SLB实例", "监听器", "ACL配置"]
  },
  "execution": {
    "execution_strategy": "SEQUENTIAL",
    "cli_commands": [
      {
        "command": ["slb", "DescribeLoadBalancers"],
        "parameters": {
          "RegionId": "$REGION_ID",
          "PageSize": 100
        },
        "tid": 0,
        "output_processing": "jq '.LoadBalancers[] | {LoadBalancerId, LoadBalancerName, RegionId}'"
      },
      {
        "command": ["slb", "DescribeLoadBalancerListeners"],
        "parameters": {
          "LoadBalancerId": "$.LoadBalancers.LoadBalancer[*].LoadBalancerId",
          "RegionId": "$REGION_ID"
        },
        "tid": 1,
        "depends_on": [0],
        "output_processing": "jq '.Listeners[] | {ListenerPort, Protocol, LoadBalancerId}'"
      },
      {
        "command": ["slb", "DescribeLoadBalancerTCPListenerAttribute"],
        "parameters": {
          "LoadBalancerId": "$.LoadBalancerId",
          "ListenerPort": "$.ListenerPort",
          "RegionId": "$REGION_ID"
        },
        "tid": 2,
        "depends_on": [1],
        "output_processing": "jq '{LoadBalancerId, ListenerPort, Protocol, AclId, AclStatus, AclType}'"
      },
      {
        "command": ["slb", "DescribeLoadBalancerUDPListenerAttribute"],
        "parameters": {
          "LoadBalancerId": "$.LoadBalancerId",
          "ListenerPort": "$.ListenerPort",
          "RegionId": "$REGION_ID"
        },
        "tid": 3,
        "depends_on": [1],
        "output_processing": "jq '{LoadBalancerId, ListenerPort, Protocol, AclId, AclStatus, AclType}'"
      },
      {
        "command": ["slb", "DescribeLoadBalancerHTTPListenerAttribute"],
        "parameters": {
          "LoadBalancerId": "$.LoadBalancerId",
          "ListenerPort": "$.ListenerPort",
          "RegionId": "$REGION_ID"
        },
        "tid": 4,
        "depends_on": [1],
        "output_processing": "jq '{LoadBalancerId, ListenerPort, Protocol, AclId, AclStatus, AclType}'"
      },
      {
        "command": ["slb", "DescribeLoadBalancerHTTPSListenerAttribute"],
        "parameters": {
          "LoadBalancerId": "$.LoadBalancerId",
          "ListenerPort": "$.ListenerPort",
          "RegionId": "$REGION_ID"
        },
        "tid": 5,
        "depends_on": [1],
        "output_processing": "jq '{LoadBalancerId, ListenerPort, Protocol, AclId, AclStatus, AclType}'"
      },
      {
        "command": ["slb", "DescribeAccessControlListAttribute"],
        "parameters": {
          "AclId": "$.AclId",
          "RegionId": "$REGION_ID"
        },
        "tid": 6,
        "depends_on": [2, 3, 4, 5],
        "output_processing": "jq '{AclId, AclName, AclEntrys: .AclEntrys[:10]}'",
        "condition": "$.AclId != null and $.AclId != \"\""
      },
      {
        "command": ["slb", "DescribeAccessControlLists"],
        "parameters": {
          "RegionId": "$REGION_ID",
          "PageSize": 100
        },
        "tid": 7,
        "output_processing": "jq '.Acls[] | {AclId, AclName, AddressIPVersion}'"
      }
    ],
    "data_flow": {
      "description": "数据流转关系",
      "flow": [
        "查询所有SLB实例",
        "遍历每个SLB实例的所有监听器",
        "根据监听器协议查询具体配置（TCP/UDP/HTTP/HTTPS）",
        "提取ACL相关字段（AclId, AclStatus, AclType）",
        "查询关联的ACL策略详情（如果存在）",
        "生成诊断报告：标记未配置ACL的监听器"
      ]
    },
    "estimated_time": "30-60秒（取决于SLB实例和监听器数量）",
    "prerequisites": {
      "required_permissions": [
        "slb:DescribeLoadBalancers",
        "slb:DescribeLoadBalancerListeners",
        "slb:DescribeLoadBalancerTCPListenerAttribute",
        "slb:DescribeLoadBalancerUDPListenerAttribute",
        "slb:DescribeLoadBalancerHTTPListenerAttribute",
        "slb:DescribeLoadBalancerHTTPSListenerAttribute",
        "slb:DescribeAccessControlListAttribute",
        "slb:DescribeAccessControlLists"
      ],
      "required_parameters": ["$REGION_ID（需要指定地域或使用默认地域）"]
    },
    "diagnostic_rules": {
      "description": "ACL配置诊断规则",
      "rules": [
        {
          "rule_name": "检查ACL是否配置",
          "condition": "$.AclId == null or $.AclId == \"\"",
          "severity": "WARNING",
          "message": "监听器未配置ACL访问控制策略，建议配置以增强安全性"
        },
        {
          "rule_name": "检查ACL状态",
          "condition": "$.AclStatus == \"off\"",
          "severity": "WARNING",
          "message": "监听器已配置ACL但未启用"
        },
        {
          "rule_name": "检查ACL类型",
          "condition": "$.AclType == \"black\"",
          "severity": "INFO",
          "message": "监听器使用黑名单模式，请确认黑名单配置正确"
        },
        {
          "rule_name": "检查ACL条目",
          "condition": "$.AclEntrys == null or ($.AclEntrys | length) == 0",
          "severity": "WARNING",
          "message": "ACL策略组为空，请添加IP地址或CIDR网段"
        }
      ]
    }
  }
}
```


## 基于用户需求配置Json，生成TODO任务清单

```markdown

# 任务分析

这是一个 L3 复杂度的诊断查询任务，目标是检查所有 SLB 实例的监听器是否配置了 ACL 访问控制策略。

生成的 TODO 任务列表

# 阿里云 SLB ACL 配置诊断任务

## 阶段 1: 环境准备
- [ ] 1.1 验证阿里云 CLI 已安装并配置 (`aliyun version`)
- [ ] 1.2 验证凭证配置有效 (`aliyun account GetProfile`)
- [ ] 1.3 确认目标地域 ($REGION_ID)，如未指定则使用默认地域
- [ ] 1.4 验证所需权限是否具备（slb:Describe* 系列权限）

## 阶段 2: 资源发现
- [ ] 2.1 查询所有 SLB 实例
      ```bash
      aliyun slb DescribeLoadBalancers --RegionId $REGION_ID --PageSize 100 \
        | jq '.LoadBalancers[] | {LoadBalancerId, LoadBalancerName, RegionId}'
     ```
  输出: 保存到 slb_instances.json

 - [ ] 2.2 遍历每个 SLB 实例，查询其监听器列表
    aliyun slb DescribeLoadBalancerListeners \
      --LoadBalancerId <LoadBalancerId> \
      --RegionId $REGION_ID \
      | jq '.Listeners[] | {ListenerPort, Protocol, LoadBalancerId}'

    输出: 保存到 slb_listeners.json

## 阶段 3: 监听器配置详情查询（并行执行）
 - [ ] 3.1 查询 TCP 监听器配置及 ACL 信息
      aliyun slb DescribeLoadBalancerTCPListenerAttribute \
        --LoadBalancerId <LoadBalancerId> \
        --ListenerPort <ListenerPort> \
        --RegionId $REGION_ID

 - [ ] 3.2 查询 UDP 监听器配置及 ACL 信息
      aliyun slb DescribeLoadBalancerUDPListenerAttribute \
        --LoadBalancerId <LoadBalancerId> \
        --ListenerPort <ListenerPort> \
        --RegionId $REGION_ID

 - [ ] 3.3 查询 HTTP 监听器配置及 ACL 信息
      aliyun slb DescribeLoadBalancerHTTPListenerAttribute \
        --LoadBalancerId <LoadBalancerId> \
        --ListenerPort <ListenerPort> \
        --RegionId $REGION_ID
 - [ ] 3.4 查询 HTTPS 监听器配置及 ACL 信息
      aliyun slb DescribeLoadBalancerHTTPSListenerAttribute \
        --LoadBalancerId <LoadBalancerId> \
        --ListenerPort <ListenerPort> \
        --RegionId $REGION_ID

## 阶段 4: ACL 详情查询
 - [ ] 4.1 查询已配置的 ACL 策略详情
    aliyun slb DescribeAccessControlListAttribute \
      --AclId <AclId> \
      --RegionId $REGION_ID \
      | jq '{AclId, AclName, AclEntrys: .AclEntrys[:10]}'
    条件: 仅当 AclId != null and AclId != "" 时执行

  - [ ] 4.2 查询地域内所有 ACL 列表（用于交叉验证）
    aliyun slb DescribeAccessControlLists \
      --RegionId $REGION_ID \
      --PageSize 100

## 阶段 5: 诊断分析与报告生成
 - [ ] 5.1 应用诊断规则
    规则1: 检查 ACL 是否配置 (AclId == null or AclId == "")
    规则2: 检查 ACL 状态 (AclStatus == "off")
    规则3: 检查 ACL 类型 (AclType == "black")
    规则4: 检查 ACL 条目 (AclEntrys == null or empty)

 - [ ] 5.2 生成诊断报告
    汇总所有监听器的 ACL 配置情况
    标记未配置 ACL 的监听器（WARNING 级别）
    标记 ACL 未启用的监听器（WARNING 级别）
    统计配置率和合规率

- [ ]  5.3 输出报告格式
    {
      "summary": {
        "total_slb": <数量>,
        "total_listeners": <数量>,
        "configured_acl": <数量>,
        "acl_enabled": <数量>,
        "compliance_rate": <百分比>
      },
      "issues": [
        {
          "loadbalancer_id": "<SLB_ID>",
          "listener_port": <端口>,
          "protocol": "<协议>",
          "severity": "WARNING/INFO",
          "message": "<诊断消息>"
        }
      ]
    }


- [ ]  阶段 6: 清理与归档
      6.1 清理临时文件（可选）
      6.2 归档查询结果和诊断报告


## 执行依赖关系图

    阶段1 → 阶段2.1 → 阶段2.2
    ↓
    阶段3 (并行) → 阶段4.1 (条件执行)
    ↓              ↓
    阶段4.2 ←─────────────┘
    ↓
    阶段5 → 阶段6

## 关键注意事项
1. **权限要求**: 需要所有 `slb:Describe*` 权限
2. **地域参数**: `$REGION_ID` 必须明确指定或使用默认地域
3. **条件执行**: 阶段 4.1 仅在监听器配置了 ACL 时执行
4. **分页处理**: 如果资源超过 100 条，需处理分页
```